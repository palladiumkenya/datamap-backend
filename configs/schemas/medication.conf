{"base_repository": "medication", "query": "SELECT CONCAT(i.siteCode, o.patient_id)                                                       AS ClientID,\n      e.name                                                                                 AS Category,\n      m.date_handed_over                                                                     AS DispenseDate,\n      i.siteCode                                                                             As FacilityID,\n      m.name                                                                                 AS Medication,\n      o.encounter_id                                                                         AS EncounterId,\n      m.type                                                                                 AS DispenseType,\n      CEILING(m.quantity)                                                                             AS Quantity,\n      CEILING(if(m.quantity is not null AND m.frequency IS NOT NULL, m.quantity / m.frequency, NULL)) AS DaysSupply,\n      m.dosing_instructions                                                                  AS Note,\n      d.name                                                                                 AS AuthorizingPrescription,\n--       CASE m.was_substituted WHEN 1 THEN 'TRUE' WHEN 0 THEN 'FALSE' END                      AS Substitution,\n      m.was_substituted                      \t\t\t\t\t\t\t\t\t\t\t\t AS Substitution,\n      m.substitution_type                                                                    AS SubstitutionType,\n      m.substitution_reason                                                                  AS SubstitutionReason\nFROM openmrs.drug_order do         inner join openmrs.orders o on do.order_id = o.order_id and o.order_type_id = 2\n      JOIN (select m.patient_id,                      m.type,                      m.date_handed_over,\n      m.quantity,                      m.dosing_instructions,                      m.was_substituted,\n      m.substitution_reason,                      d.name,                      m.drug_order_id,\n      m.substitution_type,                      m.frequency               from openmrs.medication_dispense m\n      JOIN openmrs.drug d ON d.drug_id = m.drug_id) m on do.order_id = m.drug_order_id\n      JOIN openmrs.drug d ON d.drug_id = do.drug_inventory_id         JOIN (SELECT e.encounter_id, t.name,e.voided\n      from openmrs.encounter e                        JOIN openmrs.visit v on e.visit_id = v.visit_id\n      JOIN openmrs.visit_type t on v.visit_type_id = t.visit_type_id) e              on e.encounter_id = o.encounter_id and e.voided = 0\n      JOIN kenyaemr_etl.etl_default_facility_info i     \n    ", "mappings": [{"id": "c6e091f4-51f9-11f0-a623-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "Note", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}, {"id": "c6e091f5-51f9-11f0-a0d3-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "Category", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}, {"id": "c6e091f6-51f9-11f0-92d9-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "AuthorizingPrescription", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}, {"id": "c6e091f7-51f9-11f0-8553-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "SubstitutionType", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}, {"id": "c6e091f8-51f9-11f0-aeb1-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "FacilityID", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}, {"id": "c6e091f9-51f9-11f0-8b47-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "Substitution", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}, {"id": "c6e091fa-51f9-11f0-88c0-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "SubstitutionReason", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}, {"id": "c6e091fb-51f9-11f0-96f6-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "DispenseDate", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}, {"id": "c6e091fc-51f9-11f0-b4fd-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "Medication", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}, {"id": "c6e091fd-51f9-11f0-9db5-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "ClientID", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}, {"id": "c6e091fe-51f9-11f0-b9fe-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "EncounterId", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}, {"id": "c6e091ff-51f9-11f0-874b-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "DispenseType", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}, {"id": "c6e09200-51f9-11f0-a0f3-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "DaysSupply", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}, {"id": "c6e09201-51f9-11f0-888c-00090faa0001", "base_repository": "medication", "base_variable_mapped_to": "Quantity", "tablename": "-", "columnname": "-", "datatype": "-", "join_by": "-", "created_at": "2025-06-25 22:15:23.593322", "updated_at": "2025-06-25 22:15:23.593322"}]}